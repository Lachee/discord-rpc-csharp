<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Discord Rich Presence | Discord RPC C# </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Discord Rich Presence | Discord RPC C# ">
    <meta name="generator" content="docfx ">
  
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="stylesheet" href="styles/docfx.vendor.css">
    <link rel="stylesheet" href="styles/docfx.css">
    <link rel="stylesheet" href="styles/main.css">
    <meta property="docfx:navrel" content="toc.html">
    <meta property="docfx:tocrel" content="toc.html">
  
  <meta property="docfx:rel" content="">
  
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="index.html">
                <img id="logo" class="svg" src="logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first=First data-prev=Previous data-next=Next data-last=Last></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="discord-rich-presence">Discord Rich Presence</h1>

<p><a href="https://github.com/Lachee/discord-rpc-csharp/actions/workflows/release.yml"><img src="https://github.com/Lachee/discord-rpc-csharp/actions/workflows/release.yml/badge.svg" alt="Release ðŸ“¦"></a>
<a href="https://app.codacy.com/gh/Lachee/discord-rpc-csharp/dashboard?utm_source=gh&amp;utm_medium=referral&amp;utm_content=&amp;utm_campaign=Badge_grade"><img src="https://app.codacy.com/project/badge/Grade/30c4e9f58b7f4a058f79ad0acd743edf" alt="Codacy Badge"></a> <a href="https://www.nuget.org/packages/DiscordRichPresence/"><img src="https://img.shields.io/nuget/v/DiscordRichPresence.svg" alt="Nuget"></a>
<a href="https://github.com/Lachee/discord-rpc-csharp/tags"><img src="https://img.shields.io/github/package-json/v/lachee/discord-rpc-csharp?label=master" alt="GitHub package.json version"></a></p>
<p>This is a C# <em>implementation</em> of the <a href="https://github.com/discordapp/discord-rpc">Discord RPC</a> library which was originally written in C++. This avoids having to use the official C++ and instead provides a managed way of using the Rich Presence within the .NET environment*.</p>
<p>While the official C++ library has been deprecated, this library has continued support and development for all your Rich Presence need, without requiring the Game SDK.</p>
<p>Here are some key features of this library:</p>
<ul>
<li><strong>Message Queuing</strong></li>
<li><strong>Threaded Reads</strong></li>
<li><strong>Managed Pipes</strong>*</li>
<li><strong>Error Handling</strong> &amp; <strong>Error Checking</strong> with automatic reconnects</li>
<li><strong>Events from Discord</strong> (such as presence update and join requests)</li>
<li><strong>Full Rich Presence Implementation</strong> (including Join / Spectate)</li>
<li><strong>Inline Documented</strong> (for all your IntelliSense needs)</li>
<li><strong>Helper Functionality</strong> (eg: AvatarURL generator from Join Requests)</li>
<li><strong>Ghost Prevention</strong> (Tells Discord to clear the RP on disposal)</li>
<li><strong>Full Unity3D Editor</strong> (Contains all the tools, inspectors and helpers for a Unity3D game all in one package).</li>
</ul>
<h1 id="documentation">Documentation</h1>
<p>All the documentation can be found <a href="https://lachee.github.io/discord-rpc-csharp/">lachee.github.io/discord-rpc-csharp/docs/</a></p>
<h1 id="installation">Installation</h1>
<p><strong>Dependencies:</strong></p>
<ul>
<li>Newtonsoft.Json</li>
<li>.NET Standard 2.0 runtime or .NET Framework 4.5:
<ul>
<li><code>fx 4.5</code>, <code>core 3.1</code>, <code>net 7.0</code>, <code>net 8.0</code>, <code>net 9.0</code></li>
</ul>
</li>
</ul>
<h3 id="net-project"><strong>.NET Project</strong></h3>
<p>For projects that target either the .NET Standard or .NET Framework, you can get the package on <a href="https://www.nuget.org/packages/DiscordRichPresence/">nuget</a>:</p>
<pre><code>PM&gt; Install-Package DiscordRichPresence
</code></pre>
<p>You can also <a href="#building">Download or Build</a> your own version of the library if you have more specific requirements.</p>
<h3 id="unity3d-game-engine"><strong>Unity3D Game Engine</strong></h3>
<p>Unity Package is being moved to <a href="https://github.com/Lachee/discord-rpc-unity">Lachee/Discord-RPC-Unity</a>.
Please check the releases / documentation there.</p>
<h2 id="usage">Usage</h2>
<p>The Discord.Example project within the solution contains example code, showing how to use all available features. For Unity Specific examples, check out the example project included. There are 3 important stages of usage, Initialization, Invoking and Deinitialization. It's important you follow all 3 stages to ensure proper behaviour of the library.</p>
<p><strong>Initialization</strong></p>
<p>This stage will setup the connection to Discord and establish the events. Once you have done the initialization you can call <code>SetPresence</code> and other variants as many times as you wish throughout your code. Please note that ideally this should only run once, otherwise conflicts may occur with them trying to access the same Discord client at the same time.</p>
<pre><code class="lang-csharp">public DiscordRpcClient client;

//Called when your application first starts.
//For example, just before your main loop, on OnEnable for unity.
void Initialize() 
{
	/*
	Create a Discord client
	NOTE: 	If you are using Unity3D, you must use the full constructor and define
			 the pipe connection.
	*/
	client = new DiscordRpcClient(&quot;my_client_id&quot;);			
	
	//Set the logger
	client.Logger = new ConsoleLogger() { Level = LogLevel.Warning };

	//Subscribe to events
	client.OnReady += (sender, e) =&gt;
	{
		Console.WriteLine(&quot;Received Ready from user {0}&quot;, e.User.Username);
	};
		
	client.OnPresenceUpdate += (sender, e) =&gt;
	{
		Console.WriteLine(&quot;Received Update! {0}&quot;, e.Presence);
	};
	
	//Connect to the RPC
	client.Initialize();

	//Set the rich presence
	//Call this as many times as you want and anywhere in your code.
	client.SetPresence(new RichPresence()
	{
		Details = &quot;Example Project&quot;,
		State = &quot;csharp example&quot;,
		Assets = new Assets()
		{
			LargeImageKey = &quot;image_large&quot;,
			LargeImageText = &quot;Lachee's Discord IPC Library&quot;,
			SmallImageKey = &quot;image_small&quot;
		}
	});	
}
</code></pre>
<p><strong>Invoking</strong></p>
<p><strong>Invoking is optional. Use this when thread safety is paramount.</strong></p>
<p>The client will store messages from the pipe and won't invoke them until you call <code>Invoke()</code> or <code>DequeueMessages()</code>. It does this because the pipe is working on another thread, and manually invoking ensures proper thread safety and order of operations (especially important in Unity3D applications).</p>
<p>In order to enable this method of event calling, you need to set it in the constructor of the DiscordRpcClient under <code>autoEvents</code>.</p>
<pre><code class="lang-csharp">//The main loop of your application, or some sort of timer. Literally the Update function in Unity3D
void Update() 
{
	//Invoke all the events, such as OnPresenceUpdate
	client.Invoke();
};
</code></pre>
<p>Here is an example on how a Timer could be used to invoke the events for a WinForm</p>
<pre><code class="lang-csharp">var timer = new System.Timers.Timer(150);
timer.Elapsed += (sender, args) =&gt; { client.Invoke(); };
timer.Start();
</code></pre>
<p><strong>Deinitialization</strong></p>
<p>It's important that you dispose your client before your application terminates. This will stop the threads, abort the pipe reads, and tell Discord to clear the presence. Failure to do so may result in a memory leak!</p>
<pre><code class="lang-csharp">//Called when your application terminates.
//For example, just after your main loop, on OnDisable for unity.
void Deinitialize() 
{
	client.Dispose();
}
</code></pre>
<h2 id="examples">Examples</h2>
<p>To run the current example, either open the solution in Visual Studio and run the DiscordRPC.Example project or use Dotnet:</p>
<pre><code>dotnet run --project DiscordRPC.Example
</code></pre>
<h2 id="building">Building</h2>
<p><a href="https://github.com/Lachee/discord-rpc-csharp/actions/workflows/release.yml"><img src="https://github.com/Lachee/discord-rpc-csharp/actions/workflows/release.yml/badge.svg" alt="Release ðŸ“¦"></a> <a href="https://github.com/Lachee/discord-rpc-csharp/actions/workflows/documentation.yml"><img src="https://github.com/Lachee/discord-rpc-csharp/actions/workflows/documentation.yml/badge.svg" alt="Documentation ðŸ“š"></a></p>
<p><strong>DiscordRPC Library</strong></p>
<pre><code>dotnet build -c Release
</code></pre>
<p><strong>Unity3D</strong></p>
<p>If you wish to have barebones Unity3D implementation, you need to build the <code>DiscordRPC.dll</code>, the <a href="https://github.com/Lachee/unity-named-pipes">Unity Named Pipes</a> Library and the <a href="https://github.com/Lachee/discord-rpc-csharp/blob/master/Unity%20Example/Assets/Discord%20RPC/Scripts/Control/UnityNamedPipe.cs">UnityNamedPipe.cs</a>. Put these in your own Unity Project and the <code>.dll</code>s in a folder called <code>Plugins</code>.</p>
<p><strong>UWP / .NET MAUI / WIN UI 3</strong></p>
<p>For now, the library doesn't work on UWP applications until we find the issue and fix it.</p>
<p>In order to make this library work with the WIN UI 3 related applications such as .NET MAUI, you need to define <code>runFullTrust</code> Capability inside <code>Package.appxmanifest</code>.</p>
<p>Here is an example of how to add <code>runFullTrust</code> to your WIN UI 3 application:</p>
<p><code>Package.appxmanifest</code>:</p>
<pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;

&lt;Package
  xmlns=&quot;http://schemas.microsoft.com/appx/manifest/foundation/windows10&quot;
  xmlns:uap=&quot;http://schemas.microsoft.com/appx/manifest/uap/windows10&quot;
  xmlns:rescap=&quot;http://schemas.microsoft.com/appx/manifest/foundation/windows10/restrictedcapabilities&quot;
  IgnorableNamespaces=&quot;uap rescap&quot;&gt;
  ...
    &lt;Capabilities&gt;
	    &lt;rescap:Capability Name=&quot;runFullTrust&quot; /&gt;
    &lt;/Capabilities&gt;
&lt;/Package&gt;
</code></pre>
<p>If you use .NET MAUI or WIN UI 3 template for C#, it automatically puts <code>runFullTrust</code> capability.</p>
<h2 id="tests">Tests</h2>
<p>There are currently no tests available to validate the library. This is a active issue and need help with this.
The test suite will likely need a way to mock the RPC client.</p>
<h2 id="contribution">Contribution</h2>
<p>All contributions are welcome and I am happy for any contribution. However, there are some things that will not be accepted:</p>
<ul>
<li>Spelling only fixes (rude to only contribute to something copilot could do)</li>
<li>Complete or large rewrites (unwanted work load to review)</li>
<li>Dependency substitutions / removals / additions (these require a issue and discussion first)</li>
<li>Support for features only provided by custom Discord clients</li>
<li>Obviously AI additions</li>
</ul>
<p>For more information, please read CONTRIBUTING.md</p>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/Lachee/discord-rpc-csharp/blob/master/Docfx/index.md/#L1" class="contribution-link">Edit this page</a>
                  </li>
                </ul>
              </div>
              <div class="toggle-mode">
                <div class="icon">
                  <i aria-hidden="true">â˜€</i>
                </div>
                <label class="switch">
                  <input type="checkbox" id="switch-style">
                  <span class="slider round"></span>
                </label>
                <div class="icon">
                  <i aria-hidden="true">â˜¾</i>
                </div>
              </div>

              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <h5>In this article</h5>
              <div></div>
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <div class="pull-left">
        <a href="https://github.com/Lachee/discord-rpc-csharp">Contribute</a> on GitHub
        
            </div>
            <div class="toggle-mode pull-right visible-sm visible-xs">
              <div class="icon">
                <i aria-hidden="true">â˜€</i>
              </div>
              <label class="switch">
                <input type="checkbox" id="switch-style-m">
                <span class="slider round"></span>
              </label>
              <div class="icon">
                <i aria-hidden="true">â˜¾</i>
              </div>
            </div>
          </div>
        </div>
        <script type="text/javascript" src="styles/toggle-theme.js"></script>
      </footer>    </div>

    <script type="text/javascript" src="styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="styles/docfx.js"></script>
    <script type="text/javascript" src="styles/main.js"></script>
  </body>
</html>
